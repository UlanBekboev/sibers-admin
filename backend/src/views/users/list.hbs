<h1 class="title">User List</h1>

<p class="add-user-title"><a href="/add-user">Add New User</a></p>

{{#if error}}
  <p style="color:red;">{{error}}</p>
{{/if}}

<table>
  <thead>
    <tr>
      <th><a class="link" href="/users?sort=username&order={{toggleOrder sortOrder}}">Username</a></th>
      <th><a class="link" href="/users?sort=first_name&order={{toggleOrder sortOrder}}">First Name</a></th>
      <th>Last Name</th>
      <th>Gender</th>
      <th><a class="link" href="/users?sort=birthdate&order={{toggleOrder sortOrder}}">Birthdate</a></th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {{#each users}}
      <tr>
        <td>{{this.username}}</td>
        <td>{{this.firstName}}</td>
        <td>{{this.lastName}}</td>
        <td>{{this.gender}}</td>
        <td>{{this.birthdate}}</td>
        <td class="actions">
          <a class="link" href="/users/{{this.id}}">View</a>
          <a class="link" href="/users/{{this.id}}/edit">Edit</a>
          <form action="/users/{{this.id}}/delete" method="POST" style="display:inline;">
            <input type="hidden" name="_csrf" value="{{../csrfToken}}" />
            <button class="btn-delete" type="submit" onclick="return confirm('Are you sure?')">Delete</button>
          </form>
        </td>
      </tr>
    {{/each}}
  </tbody>
</table>

<div class="pagination">
  {{#if (gt totalPages 1)}}
    {{#each (range 1 totalPages)}}
      <a class="link" href="/users?page={{this}}&sort={{../sortField}}&order={{../sortOrder}}"
         class="{{#if (eq this ../currentPage)}}active{{/if}}">
        {{this}}
      </a>
    {{/each}}
  {{/if}}
</div>